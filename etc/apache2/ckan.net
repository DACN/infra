<VirtualHost *:80>
    ServerName ckan.net
    ServerAlias www-api.ckan.net
    ServerAlias www.ckan.net
    ServerAlias www2.ckan.net

    Alias /dump /home/okfn/var/srvc/ckan.net/dumps
    RedirectMatch permanent /package/read/(.*)$ http://ckan.net/package/$1

    RewriteEngine on
    RewriteCond %{HTTP_HOST} ^www\.ckan\.net$ [NC]
    RewriteRule ^(.*)$ http://ckan.net$1 [R=301,L]

    # CORS - http://lists.w3.org/Archives/Public/public-lod/2010Oct/0181.html
    Header add Access-Control-Allow-Origin "*"

    # hacks to control java robot that is hammering the site 2010-05-07
    <Location />
    Deny from 64.93.41.50
    Deny from 76.87.90.4
    </Location>

    # <LocationMatch ^/package/rate.*>
    #    Deny from all
    #</LocationMatch>

RewriteEngine on
RewriteCond %{HTTP_user_agent} Java/1.6.0_20 [NC]
RewriteRule .* - [F] 
    # end hacks

    # Disable the mod_python handler for static files
    <Location /dump>
        SetHandler None
        Options +Indexes
    </Location>

    WSGIScriptAlias / /home/okfn/var/srvc/ckan.net/pyenv/bin/ckan.net.py
    # WSGIDaemonProcess ckan.net display-name=ckan.net processes=8 threads=1 maximum-requests=1000
    # WSGIProcessGroup ckan.net

    # pass authorization info on (needed for rest api)
    WSGIPassAuthorization On

    ErrorLog /var/log/apache2/ckan.net.error.log
    CustomLog /var/log/apache2/ckan.net.custom.log combined
</VirtualHost>
